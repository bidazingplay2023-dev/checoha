<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chè Cô Hà (Modern UI)</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    <script type="importmap">
    {
      "imports": {
        "path": "https://esm.sh/path@^0.12.7",
        "vite": "https://esm.sh/vite@^7.3.0",
        "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2",
        "url": "https://esm.sh/url@^0.11.4",
        "react/": "https://esm.sh/react@^19.2.3/",
        "react": "https://esm.sh/react@^19.2.3",
        "react-dom/": "https://esm.sh/react-dom@^19.2.3/"
      }
    }
    </script>
    <style>
        /* --- RESET & GLOBAL VARS --- */
        :root {
            /* Modern Palette */
            --primary-color: #3b82f6; 
            --primary-dark: #2563eb;
            --bg-body: #f1f5f9;
            --surface-color: #ffffff;
            --text-main: #1e293b;
            --text-sub: #64748b;
            --danger-color: #ef4444;
            --danger-bg: #fee2e2;
            
            /* Spacing & Radius */
            --radius-lg: 16px;
            --radius-md: 12px;
            --radius-sm: 8px;
            
            /* Shadows */
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
            --shadow-float: 0 10px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        html, body { 
            width: 100%; height: 100%; margin: 0; padding: 0; 
            overflow: hidden; 
            font-family: 'Roboto', sans-serif; 
            background-color: var(--bg-body); 
            color: var(--text-main);
            font-size: 14px; 
            overscroll-behavior: none;
        }

        /* --- LAYOUT CONTAINER --- */
        #ui-container {
            position: fixed; inset: 0;
            display: flex; flex-direction: column;
            background: var(--bg-body);
            z-index: 1;
        }

        /* --- 1. TOP BAR --- */
        #top-bar {
            flex: 0 0 auto;
            height: 64px;
            padding: 0 16px;
            background: var(--surface-color);
            z-index: 10;
            display: flex; align-items: center; gap: 12px;
            box-shadow: var(--shadow-sm);
            border-bottom: 1px solid #e2e8f0;
        }

        #search-box { 
            flex: 1;
            padding: 0 20px; 
            border: 1px solid #cbd5e1; 
            border-radius: 99px; 
            font-size: 15px; 
            outline: none; 
            background: #f8fafc;
            color: var(--text-main);
            height: 44px;
            transition: all 0.2s;
        }
        #search-box:focus { 
            background: #fff; 
            border-color: var(--primary-color); 
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }
        
        .btn-stats-icon {
            width: 44px; height: 44px;
            border-radius: 14px; border: none;
            background: #eff6ff;
            color: var(--primary-dark);
            font-size: 20px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; flex-shrink: 0;
            transition: transform 0.1s;
        }
        .btn-stats-icon:active { transform: scale(0.92); }

        /* --- 2. MAIN AREA --- */
        #main-split-view {
            flex: 1; display: flex; flex-direction: column; 
            overflow: hidden; position: relative;
        }

        /* --- LEFT PANEL (MENU) --- */
        #left-panel {
            flex: 1; 
            overflow-y: auto; 
            -webkit-overflow-scrolling: touch; 
            padding: 16px; 
            padding-bottom: 24px;
        }

        .menu-section { margin-bottom: 20px; }
        
        .section-title { 
            font-weight: 800; font-size: 13px; text-transform: uppercase; letter-spacing: 0.5px;
            margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; 
            padding-left: 4px; color: var(--text-sub);
        }
        
        /* GRID MENU CARD */
        .group-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        
        .btn-che { 
            width: 100%; min-height: 80px; padding: 12px; 
            background-color: var(--surface-color); 
            border: 1px solid transparent; 
            border-radius: var(--radius-lg); 
            cursor: pointer; display: flex; flex-direction: column; 
            align-items: flex-start; justify-content: space-between; text-align: left; 
            box-shadow: var(--shadow-sm);
            transition: all 0.1s ease;
            position: relative; overflow: hidden;
        }
        
        /* Active State Animation */
        .btn-che:active { 
            transform: scale(0.96); 
            background-color: #f8fafc;
        }

        /* Border Color Coding */
        .bg-15k .btn-che { border-left: 4px solid #f59e0b; }
        .bg-20k .btn-che { border-left: 4px solid #0ea5e9; }
        .bg-high .btn-che { border-left: 4px solid #f43f5e; }

        .che-name { 
            font-size: 14px; font-weight: 600; line-height: 1.4; 
            color: var(--text-main); margin-bottom: 4px;
            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
        }
        .che-price { 
            font-size: 12px; font-weight: 700; 
            color: var(--text-sub); 
            background: #f1f5f9; padding: 4px 8px; border-radius: 6px; 
        }

        /* --- RIGHT PANEL (CART) --- */
        #right-panel {
            flex: 0 0 auto; 
            max-height: 60%;
            background: var(--surface-color);
            border-top-left-radius: 24px; border-top-right-radius: 24px;
            display: flex; flex-direction: column;
            box-shadow: var(--shadow-float);
            z-index: 20; border-top: 1px solid #e2e8f0;
        }

        #cart-container { 
            display: flex; flex-direction: column; flex: 1; 
            background: white; overflow: hidden; min-height: 0;
        }
        
        #cart-header { 
            flex: 0 0 auto; padding: 14px 20px; 
            background: #fff; border-bottom: 1px solid #f1f5f9; 
            font-size: 15px; font-weight: 700; color: var(--text-main);
            display: flex; justify-content: space-between; align-items: center; 
        }
        #count-display { 
            background: #eff6ff; color: #1d4ed8; 
            padding: 4px 10px; border-radius: 99px; 
            font-size: 13px; font-weight: 800;
        }

        #cart-list { 
            flex: 1 1 auto; overflow-y: auto; 
            -webkit-overflow-scrolling: touch; 
            padding: 0 20px; min-height: 0;
        }

        .cart-item { padding: 16px 0; border-bottom: 1px solid #f1f5f9; }
        
        .item-row-top { 
            display: flex; justify-content: space-between; align-items: center; 
            gap: 12px;
        }

        .item-left { 
            flex: 1; display: flex; flex-direction: column; justify-content: center;
        }
        .item-name { font-weight: 700; font-size: 14px; color: #334155; }
        .item-price-single { font-size: 12px; color: #94a3b8; margin-top: 2px; }

        .item-right { 
            display: flex; align-items: center; 
            gap: 12px; /* GAP QUAN TRỌNG: Tách nút xóa ra xa */
        }
        
        /* QUANTITY CONTROLS (Pill Shape) */
        .qty-group {
            display: flex; align-items: center;
            background: #fff;
            border-radius: 10px;
            height: 40px;
            padding: 2px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 1px 2px rgba(0,0,0,0.03);
        }

        .qty-btn { 
            width: 36px; height: 100%;
            border: none; background: transparent; 
            color: var(--primary-color); 
            font-weight: bold; font-size: 18px; 
            display: flex; align-items: center; justify-content: center; 
            cursor: pointer; border-radius: 8px;
            transition: all 0.1s;
        }
        .qty-btn:active { background-color: #f1f5f9; transform: scale(0.9); }

        .qty-input {
            width: 32px; height: 100%; border: none;
            background: transparent;
            text-align: center; font-size: 14px; font-weight: 700; color: #0f172a;
            outline: none; -moz-appearance: textfield; padding: 0;
        }
        .qty-input::-webkit-outer-spin-button, .qty-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

        /* DELETE BUTTON - DANGER ZONE */
        .delete-btn { 
            color: var(--danger-color); 
            background: var(--danger-bg); 
            width: 40px; height: 40px; border-radius: 10px; 
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-size: 16px; font-weight: bold;
            transition: transform 0.1s;
            /* Đảm bảo không bấm nhầm */
            border: 1px solid transparent;
        }
        .delete-btn:active { transform: scale(0.9); border-color: #fca5a5; }
        
        .option-row { margin-top: 8px; }
        .label-note { 
            font-size: 12px; font-weight: 500; color: #64748b; 
            display: flex; align-items: center; cursor: pointer; user-select: none;
        }
        .note-input { 
            width: 100%; padding: 8px 12px; margin-top: 6px; 
            border: 1px solid #cbd5e1; border-radius: 8px; font-size: 13px; 
            transition: border 0.2s;
        }
        .note-input:focus { border-color: var(--primary-color); outline: none; }

        /* --- BOTTOM CONTROLS --- */
        #bottom-controls {
            flex: 0 0 auto; padding: 20px;
            background: white; border-top: 1px solid #f1f5f9;
            padding-bottom: max(20px, env(safe-area-inset-bottom));
        }

        #total-bar { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 16px; }
        #total-price { font-size: 24px !important; color: var(--text-main); font-weight: 900; line-height: 1; }
        
        .action-row { display: flex; gap: 12px; }
        .action-btn { 
            flex: 1; padding: 16px; font-size: 14px; border: none; 
            border-radius: 14px; cursor: pointer; font-weight: 700; 
            text-transform: uppercase; letter-spacing: 0.5px;
            transition: transform 0.1s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .action-btn:active { transform: scale(0.98); }
        
        #btn-print { 
            background: linear-gradient(135deg, #3b82f6, #2563eb); 
            color: white; flex: 2; 
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25);
        }
        #btn-clear { background: #f1f5f9; color: #64748b; flex: 1; }

        /* RESPONSIVE TABLET/PC */
        @media (min-width: 768px) {
            #main-split-view { max-width: 1200px; margin: 0 auto; padding: 30px; gap: 30px; }
            #left-panel { border-radius: 24px; box-shadow: var(--shadow-sm); background: white; padding: 24px;}
            #right-panel { border-radius: 24px; box-shadow: var(--shadow-float); border: none; max-height: 100%;}
            .group-grid { grid-template-columns: repeat(4, 1fr); gap: 16px; }
            .btn-che { min-height: 100px; padding: 16px; }
            .che-name { font-size: 15px; }
        }

        /* MODALS */
        .modal-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(15, 23, 42, 0.4); z-index: 999; 
            display: flex; align-items: center; justify-content: center; 
            backdrop-filter: blur(8px);
        }
        .modal-box { 
            background: white; width: 90%; max-width: 400px; 
            border-radius: 24px; padding: 24px; 
            box-shadow: var(--shadow-float); 
            display: flex; flex-direction: column;
        }
        .modal-title { font-size: 18px; font-weight: 800; margin-bottom: 20px; text-align: center; color: var(--text-main); }
        
        .confirm-list { border: 1px solid #f1f5f9; border-radius: 12px; padding: 16px; background: #f8fafc; }
        .btn-confirm { background: #10b981; color: white; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2); }
        
        #toast { 
            visibility: hidden; min-width: 200px; 
            background-color: #1e293b; color: #fff; 
            text-align: center; border-radius: 99px; padding: 12px 24px; 
            position: fixed; z-index: 1000; left: 50%; transform: translateX(-50%); bottom: 100px; 
            font-size: 14px; font-weight: 600; 
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
        }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }

        @media print {
            @page { 
                /* AUTO SIZE: Quan trọng để khớp với khổ giấy người dùng chọn */
                size: auto; 
                margin: 0mm; 
            } 
            
            html, body { 
                width: 100%; 
                height: 100%; 
                margin: 0 !important; 
                padding: 0 !important; 
                overflow: visible !important; 
                background: white !important;
            }

            /* Hide UI */
            #ui-container, .modal-overlay, #toast { 
                display: none !important; 
            }

            /* Show Print Section */
            #print-section { 
                display: block !important; 
                width: 100% !important; 
                height: auto !important;
                background-color: white; 
                overflow: visible !important;
                z-index: 9999; 
            }

            .sticker { 
                width: 100%; 
                height: 100%; /* Cố gắng chiếm toàn bộ trang (1 tem/trang) */
                box-sizing: border-box;
                padding: 2mm; /* Padding tối thiểu */
                
                display: flex; 
                flex-direction: column; 
                justify-content: center; /* Căn giữa dọc */
                align-items: center; /* Căn giữa ngang */
                
                /* Page break logic */
                page-break-after: always !important; 
                break-after: page !important; 
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            .sticker-name { 
                font-family: 'Roboto', Arial, sans-serif !important; 
                font-size: 22px; 
                font-weight: 900; 
                text-transform: uppercase; 
                line-height: 1.1; 
                text-align: center; 
                color: #000; 
                
                /* Đảm bảo text không bị mất nếu giấy quá nhỏ */
                word-wrap: break-word; 
                overflow-wrap: break-word;
                max-width: 100%;
            }

            .sticker-custom-note { 
                font-family: 'Roboto', Arial, sans-serif !important; 
                font-size: 16px; 
                font-weight: bold; 
                background-color: #000; 
                color: #fff !important; 
                padding: 4px 10px; 
                border-radius: 4px; 
                margin-top: 5px; 
                text-align: center; 
                -webkit-print-color-adjust: exact; 
                print-color-adjust: exact; 
                
                /* Wrap text cho note */
                word-wrap: break-word;
                overflow-wrap: break-word;
                max-width: 100%;
            }
        }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root"></div>
    <!-- Container for printing logic -->
    <div id="print-section"></div>
    <script type="module" src="/index.tsx"></script>
</body>
</html>