<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chè Cô Hà (App Mode)</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- CẤU TRÚC APP VIEW (FIXED HEIGHT) --- */
        * { box-sizing: border-box; }
        html, body { 
            height: 100%; 
            margin: 0; 
            padding: 0; 
            overflow: hidden; /* Chặn cuộn toàn trang */
            font-family: 'Roboto', sans-serif; 
            background-color: #f0f2f5; 
        }

        /* Container chính: Chia lớp theo chiều dọc */
        #ui-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            max-width: 100%;
            margin: 0 auto;
        }

        /* 1. THANH TÌM KIẾM (LUÔN Ở TRÊN CÙNG) */
        #top-bar {
            flex: 0 0 auto;
            padding: 8px 10px;
            background: #fff;
            border-bottom: 1px solid #ddd;
            z-index: 10;
            display: flex; /* Sắp xếp ngang */
            align-items: center;
            gap: 10px;
        }
        #search-box { 
            flex: 1; /* Tự động chiếm khoảng trống còn lại */
            padding: 10px 15px; 
            border: 1px solid #ddd; 
            border-radius: 20px; 
            font-size: 15px; 
            outline: none; 
            background: #f9f9f9;
        }
        #search-box:focus { background: #fff; border-color: #2196f3; }
        
        /* Nút thống kê icon nhỏ gọn */
        .btn-stats-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background-color: #f3e5f5;
            color: #7b1fa2;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        .btn-stats-icon:active {
            background-color: #e1bee7;
            transform: scale(0.95);
        }

        /* 2. KHU VỰC GIỮA (CHỨA MENU VÀ CART TRÊN PC) */
        #main-split-view {
            flex: 1;
            display: flex;
            flex-direction: column; /* Mobile: Dọc */
            overflow: hidden; /* Để con cuộn */
            position: relative;
        }

        /* KHU VỰC MENU (CUỘN ĐỘC LẬP) */
        #left-panel {
            flex: 1; /* Chiếm hết phần thừa */
            overflow-y: auto; /* Cho phép cuộn danh sách món */
            padding: 10px;
            background: #f0f2f5;
            -webkit-overflow-scrolling: touch;
        }

        /* KHU VỰC GIỎ HÀNG (CỐ ĐỊNH Ở ĐÁY TRÊN MOBILE) */
        #right-panel {
            flex: 0 0 auto; /* Không co giãn tự do, chiều cao theo nội dung hoặc cố định */
            background: white;
            border-top: 1px solid #ccc;
            display: flex;
            flex-direction: column;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.1);
            z-index: 20;
            padding: 0;
        }

        /* --- CHI TIẾT GIAO DIỆN --- */
        
        /* Menu */
        .menu-section { border-radius: 8px; padding: 8px; text-align: left; background: white; margin-bottom: 10px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); transition: all 0.2s; }
        .bg-15k { background-color: #fffde7; border: 1px solid #fff9c4; } 
        .bg-20k { background-color: #e1f5fe; border: 1px solid #b3e5fc; } 
        .bg-high { background-color: #ffebee; border: 1px solid #ffcdd2; } 
        
        /* CẬP NHẬT: Header có thể click */
        .section-title { 
            font-weight: 700; font-size: 13px; text-transform: uppercase; 
            margin-bottom: 6px; display: flex; justify-content: space-between; align-items: center; 
            color: #333; padding-left: 2px; 
            cursor: pointer; user-select: none;
        }
        .bg-15k .section-title { color: #f57f17; }
        .bg-20k .section-title { color: #01579b; }
        .bg-high .section-title { color: #b71c1c; }
        
        .toggle-icon { font-size: 14px; color: #666; font-weight: normal; }

        .group-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
        
        /* Nút món ăn: Tối ưu diện tích */
        .btn-che { 
            width: 100%; min-height: 55px; padding: 4px; 
            background-color: #fff; color: #333; 
            border: 1px solid #eee; border-radius: 6px; 
            cursor: pointer; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; text-align: center; 
            box-shadow: 0 1px 1px rgba(0,0,0,0.05);
            position: relative; overflow: hidden;
        }
        .btn-che:active { background-color: #e3f2fd; border-color: #2196f3; transform: translateY(1px); }
        .che-name { font-size: 11px; font-weight: 700; line-height: 1.2; margin-bottom: 2px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .che-price { font-size: 10px; color: #555; font-weight: 500; background: #eee; padding: 1px 5px; border-radius: 4px; }

        /* Giao diện Giỏ hàng (Tối ưu không gian) */
        #cart-container { 
            display: flex; 
            flex-direction: column; 
            max-height: 35vh; /* Giới hạn chiều cao giỏ hàng trên mobile để không che hết menu */
            background: white;
        }
        
        #cart-header { 
            padding: 8px 10px; 
            background: #f8f9fa; 
            border-bottom: 1px solid #eee; 
            color: #444; 
            font-size: 13px; 
            font-weight: bold; 
            display: flex; justify-content: space-between; align-items: center; 
        }
        
        #cart-list { 
            padding: 0 10px; 
            overflow-y: auto; /* Cuộn riêng phần danh sách món đã chọn */
            flex: 1; /* Chiếm phần còn lại của cart container */
            min-height: 60px;
        }

        .cart-item { padding: 8px 0; border-bottom: 1px dashed #eee; }
        .item-row-top { display: flex; justify-content: space-between; align-items: center; }
        .item-left { display: flex; align-items: center; gap: 6px; width: 65%;}
        .item-qty-badge { background: #e3f2fd; color: #1565c0; font-weight: bold; padding: 1px 6px; border-radius: 4px; font-size: 12px; border: 1px solid #90caf9; min-width: 25px; text-align: center;}
        .item-name { font-weight: 700; font-size: 13px; color: #333; }
        .item-right { display: flex; align-items: center; gap: 4px; }
        .qty-btn { width: 24px; height: 24px; border-radius: 50%; border: 1px solid #ddd; background: #fff; color: #333; font-weight: bold; font-size: 14px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .qty-btn:active { background: #ddd; }
        .delete-btn { color: white; background: #ef5350; width: 24px; height: 24px; border-radius: 4px; text-align: center; line-height: 24px; cursor: pointer; font-weight: bold; font-size: 12px; margin-left: 4px; }
        
        .option-row { font-size: 12px; color: #666; margin-top: 4px; display: flex; align-items: center; }
        .note-input { width: 100%; padding: 6px; margin-top: 4px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px; background: #fafafa; }

        /* Thanh điều khiển cuối cùng (Total + Buttons) */
        #bottom-controls {
            padding: 8px 10px;
            background: white;
            border-top: 1px solid #eee;
        }

        #total-bar { 
            background-color: #fff8e1; color: #f57f17; 
            padding: 8px 12px; font-size: 16px; font-weight: 700; 
            border-radius: 6px; margin-bottom: 8px; 
            border: 1px solid #ffe082; display: flex; justify-content: space-between; align-items: center; 
        }
        
        .action-row { display: flex; gap: 6px; margin-bottom: 0; }
        .action-btn { 
            flex: 1; padding: 10px; font-size: 14px; border: none; 
            border-radius: 6px; cursor: pointer; font-weight: bold; 
            text-transform: uppercase; box-shadow: 0 2px 3px rgba(0,0,0,0.1); 
            font-family: 'Roboto', sans-serif; 
        }
        .action-btn:active { opacity: 0.8; transform: scale(0.98); }
        #btn-print { background-color: #1976d2; color: white; flex: 2; font-size: 15px; }
        #btn-stats { background-color: #7b1fa2; color: white; flex: 1; }
        #btn-clear { background-color: #78909c; color: white; flex: 1; }
        
        .security-note { font-size: 10px; color: #aaa; text-align: center; margin-top: 5px; }

        /* --- RESPONSIVE: MÀN HÌNH MÁY TÍNH / TABLET --- */
        @media (min-width: 768px) {
            #main-split-view {
                flex-direction: row; /* Chuyển thành 2 cột ngang */
                max-width: 1200px;
                margin: 0 auto;
                width: 100%;
                padding: 15px;
                gap: 15px;
            }

            #top-bar { padding: 15px; text-align: center; border-bottom: none; background: #f0f2f5; }
            #search-box { max-width: 600px; padding: 15px; font-size: 16px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

            #left-panel {
                flex: 2; /* Menu rộng gấp đôi cart */
                border-radius: 12px;
                background: transparent;
                padding-right: 5px;
            }
            
            #right-panel {
                flex: 1;
                height: 100%; /* Full chiều cao khu vực giữa */
                border-radius: 12px;
                border: none;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                max-width: 400px;
                overflow: hidden;
            }

            #cart-container {
                flex: 1; /* Cart list giãn hết mức có thể trên PC */
                max-height: none; 
            }
            
            #cart-list { max-height: none; } /* PC không giới hạn chiều cao list */
            
            .group-grid { grid-template-columns: repeat(4, 1fr); gap: 10px; }
            .btn-che { min-height: 80px; padding: 10px; }
            .che-name { font-size: 14px; margin-bottom: 5px; }
            .che-price { font-size: 13px; }
        }

        /* --- MÀN HÌNH RẤT NHỎ --- */
        @media (max-width: 360px) {
            .group-grid { grid-template-columns: repeat(2, 1fr); }
        }

        /* --- MODAL CSS (Giữ nguyên) --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 999; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(2px); }
        .modal-box { background: white; width: 90%; max-width: 450px; border-radius: 12px; padding: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); text-align: left; max-height: 85vh; display: flex; flex-direction: column; }
        .modal-title { font-size: 16px; font-weight: bold; margin-bottom: 10px; text-align: center; color: #333; border-bottom: 1px solid #eee; padding-bottom: 8px;}
        .confirm-list { overflow-y: auto; margin-bottom: 10px; flex-grow: 1; border: 1px solid #f0f0f0; border-radius: 6px; padding: 8px; background: #fafafa;}
        .confirm-row { display: flex; justify-content: space-between; margin-bottom: 8px; border-bottom: 1px dashed #ddd; padding-bottom: 6px; font-size: 13px;}
        .confirm-total { font-size: 16px; font-weight: bold; color: #d32f2f; text-align: right; margin-bottom: 10px; }
        .modal-btn-group { display: flex; gap: 8px; margin-top: auto;}
        .modal-btn { flex: 1; padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 13px; text-transform: uppercase; }
        .btn-confirm { background: #43a047; color: white; }
        .btn-cancel { background: #bdbdbd; color: #333; }

        /* --- TABS CSS (Giữ nguyên) --- */
        .tabs-container { display: flex; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; margin-bottom: 15px; }
        .tab-btn { flex: 1; padding: 8px 0; border: none; background: #f5f5f5; cursor: pointer; font-size: 11px; font-weight: bold; color: #666; border-right: 1px solid #ddd; }
        .tab-btn:last-child { border-right: none; }
        .tab-btn.active { background: #1976d2; color: white; }
        .stat-display-area { text-align: center; padding: 5px 0 15px 0; }
        .stat-big-value { font-size: 32px; font-weight: 900; color: #1565c0; margin-bottom: 5px; }
        .stat-label { font-size: 13px; color: #777; font-style: italic; }
        #date-picker-area { margin-top: 10px; display: none; flex-direction: column; align-items: center; gap: 8px;}
        .date-input { padding: 8px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; width: 70%; text-align: center;}
        .btn-search-date { padding: 8px 20px; background: #ff9800; color: white; border: none; border-radius: 6px; font-weight: bold; }
        .stat-count-info { font-size: 12px; color: #999; margin-top: 10px; border-top: 1px dashed #eee; padding-top: 8px;}
        #loading { display:none; color: #666; font-style: italic; text-align: center; margin-bottom: 10px; font-size: 12px;}

        /* --- TOAST & PRINT --- */
        #toast { visibility: hidden; min-width: 250px; margin-left: -125px; background-color: #323232; color: #fff; text-align: center; border-radius: 4px; padding: 12px; position: fixed; z-index: 1000; left: 50%; bottom: 80px; font-size: 14px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        #toast.show { visibility: visible; -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        
        @media print {
            @page { margin: 0; } 
            body { margin: 0; padding: 0; background: white; overflow: visible; height: auto; } 
            #ui-container, .modal-overlay, #toast, .security-note { display: none !important; }
            #print-section { display: block !important; width: 100%; background-color: white; }
            .sticker { width: 100%; padding: 1mm 0; display: flex; flex-direction: column; justify-content: center; align-items: center; page-break-after: always; break-after: page; }
            .sticker-name { font-family: 'Roboto', Arial, sans-serif !important; font-size: 22px; font-weight: 900; text-transform: uppercase; line-height: 1; text-align: center; color: #000; }
            .sticker-custom-note { font-family: 'Roboto', Arial, sans-serif !important; font-size: 15px; font-weight: bold; background-color: #000; color: #fff !important; padding: 2px 8px; border-radius: 4px; margin-top: 3px; text-align: center; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root"></div>
    <script type="module" src="./index.tsx"></script>
<script type="module" src="/index.tsx"></script>
</body>
</html>